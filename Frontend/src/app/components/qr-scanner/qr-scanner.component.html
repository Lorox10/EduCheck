<div class="scanner-container">
    <h1>Escaneo de Asistencia</h1>

    <!-- Mensaje de estado -->
    <div *ngIf="message" class="message" [ngClass]="messageType">
        {{ message }}
    </div>

    <!-- Indicador de carga -->
    <div *ngIf="isInitializing" class="loading">
        <p>游댃 Iniciando c치mara...</p>
    </div>

    <!-- Scanner con video y canvas superpuesto -->
    <div class="scanner-wrapper" *ngIf="hasPermission" [ngClass]="{
           'scanner-success': messageType === 'success' && message,
           'scanner-error': messageType === 'error' && message
         }">
        <video #video playsinline autoplay></video>
        <canvas #canvas class="qr-canvas"></canvas>
    </div>

    <div *ngIf="!hasPermission && permissionDenied" class="no-permission">
        <p>游닝 Se necesita permiso para acceder a la c치mara</p>
        <p>Por favor, autoriza el acceso cuando el navegador lo solicite</p>
        <button class="permission-btn" (click)="requestPermission()">
            游댑 Solicitar Permiso de C치mara
        </button>
        <div class="help-text">
            <p><strong>쯅o funciona?</strong></p>
            <p>1. Busca el icono 游꿘 en la barra de direcciones</p>
            <p>2. Haz clic y selecciona "Permitir"</p>
            <p>3. Recarga la p치gina (F5)</p>
        </div>
    </div>

    <!-- Selector de c치mara (si hay m칰ltiples) -->
    <div *ngIf="availableDevices.length > 1 && hasPermission" class="camera-selector">
        <label for="camera-select">C치mara:</label>
        <select id="camera-select" [value]="currentDeviceId" (change)="onCameraChange($event)">
            <option *ngFor="let device of availableDevices" [value]="device.deviceId">
                {{ device.label || 'C치mara ' + (availableDevices.indexOf(device) + 1) }}
            </option>
        </select>
    </div>

    <!-- Informaci칩n -->
    <div *ngIf="hasPermission" class="instructions">
        <p>游님 El marco verde seguir치 autom치ticamente el c칩digo QR</p>
        <p>Funciona en cualquier 치ngulo o posici칩n</p>
        <p>El registro es autom치tico al detectarlo</p>
    </div>
</div>